<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>読書ダッシュボード</title>

  <!-- Styles -->
  <link rel="stylesheet" href="./home.css" />
  <link rel="stylesheet" href="./ranking.css" />
  <link rel="stylesheet" href="./search.css" />
  <!-- jQuery / Chart.js -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <!-- 共通スクリプト -->
  <script src="./insertHTML.js" defer></script>
  <script src="./pageswap.js" defer></script>
</head>
<body>
  <div class="app">
    <!-- ======= Header ======= -->
    <header>
      <div id="header"></div>
    </header>

    <!-- ======= Main ======= -->
    <main>
      <!-- ===== Sidebar ===== -->
      <aside class="sidebar">
        <!-- 今月の読書数 / 進捗エリア -->
        <section class="panel">
          <div class="hd">今月の読書数</div>
          <div class="bd">
            <div style="font-size:32px; font-weight:800; margin-bottom:4px;">
              <span id="monthlyCount">0</span>
              <small style="font-size:14px; color:var(--muted, #666); margin-left:2px;">冊</small>
            </div>

            <p class="muted" style="margin:8px 0 10px;">現在の進捗</p>
            <div id="inProgressArea" style="display:grid;gap:10px;">
              <!-- progressupdate.js が 100%未満の本を描画します -->
            </div>
          </div>
        </section>

        <!-- 本の検索 -->
        <section class="panel">
          <div class="hd">本のタイトル検索</div>
          <div class="bd search-bd">
            <input type="text" id="bookTitleInput" placeholder="タイトルを入力" />
            <nav><button onclick="showPage('kensaku')" id="searchBookBtn">検索</button></nav>
          </div>
        </section>

        <!-- 任意のチップ -->
        <!-- <section class="panel">
          <div class="hd">ジャンルから選ぶ</div>
          <div class="bd">
            <div class="chips" aria-label="ジャンル">
              <span class="chip">ビジネス</span>
              <span class="chip">小説</span>
              <span class="chip">技術・IT</span>
              <span class="chip">芸術・文化</span>
              <span class="chip">数学</span>
            </div>
          </div>
        </section>

        <section class="panel">
          <div class="hd">人気のワードから選ぶ</div>
          <div class="bd">
            <div class="chips">
              <span class="chip">統計</span>
              <span class="chip">AWS</span>
              <span class="chip">Azure</span>
              <span class="chip">デザイン</span>
            </div>
          </div>
        </section>

        <section class="panel">
          <div class="hd">著者名から選ぶ</div>
          <div class="bd">
            <div class="chips">
              <span class="chip">AWS</span>
              <span class="chip">Azure</span>
              <span class="chip">TK</span>
            </div>
          </div>
        </section> -->
      </aside>

      <!-- ===== Content ===== -->
      <section class="content">
        <!-- ホーム -->
        <div id="home" class="page active">
          <section class="graphpanel">
            <iframe id="graphFrame" src="graph.html" width="100%"
              style="border:none; display:block; padding:0; margin:0;"></iframe>
            <script src="./home.js"></script>
          </section>
        </div>


        <!-- トースト表示エリア -->
        <div id="toastContainer" class="toast-container"></div>

        <!-- 検索ページ -->
        <div id="kensaku" class="page"></div>

        <!-- その他ページ -->
        <!-- <div id="recomend" class="page">
          <section class="panel">
            <div class="bd">
              <div class="section-hd">
                <strong>あなたへのおすすめ</strong>
                <span class="muted">更新: 今日</span>
              </div>
              <div class="rail" aria-label="あなたへのおすすめ一覧">
                <div class="book"></div><div class="book"></div><div class="book"></div><div class="book"></div><div class="book"></div>
              </div>
            </div>
          </section>
        </div>

        <div id="popular" class="page">
          <section class="panel">
            <div class="bd">
              <div class="section-hd">
                <strong>みんなが読んでいる本</strong>
                <span class="muted">リアルタイム</span>
              </div>
              <div class="rail" aria-label="トレンド本一覧">
                <div class="book"></div><div class="book"></div><div class="book"></div><div class="book"></div><div class="book"></div>
              </div>
            </div>
          </section>
        </div> -->

        <div id="mypage" class="page"></div>
      </section>
    </main>
  </div>

  <!-- 検索（既存） -->
  <script src="./search.js" defer></script>

  <!-- 進捗エディタ（新 UI・自動保存） -->
  <script src="./progressupdate.js" defer></script>

  <!-- ランキング iframe → 今月冊数の反映 -->
  <script>
    window.addEventListener('message', (e) => {
      const data = e?.data;
      if (!data || typeof data !== 'object') return;

      if (data.type === 'monthly-count') {
        const el = document.getElementById('monthlyCount');
        if (el) el.textContent = Number(data.count || 0);
      }
      // 月変更（month-change）は progressupdate.js 側で受けて進捗リストを再描画
    });
  </script>

</body>
</html>